  console.log
    [TEST] Decompiled 19666 hex chars → 15000 chars in 2415ms

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:89:17)

  console.log
    [TEST] First 300 chars:
    // SPDX-License-Identifier: MIT
    pragma solidity >=0.8.0;
    
    /// @title            Decompiled Contract
    /// @author           Jonathan Becker <jonathan@jbecker.dev>
    /// @custom:version   heimdall-rs v0.9.2
    ///
    /// @notice           This contract was decompiled using the heimdall-rs decompiler.
    ///

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:90:17)

  console.log
    [TEST] Live bytecode for AegisModule: 19666 hex chars

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:120:17)

  console.log
    [TEST] Full pipeline: Base Sepolia → Heimdall → 15000 chars of decompiled code

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:147:17)

  console.log
    [TEST] Step 1: Fetched 19666 hex chars from Base Sepolia

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:169:17)

  console.log
    [TEST] Step 2: Heimdall decompiled → 8000 chars

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:180:17)

  console.log
    [TEST] Step 3: GPT-4o raw response: {
      "obfuscatedTax": false,
      "privilegeEscalation": true,
      "externalCallRisk": false,
      "logicBomb": false,
      "is_malicious": true,
      "reasoning": "The contract contains privilege escalation where only the owner can subscribe agents, indicating potential centralization and misuse."
    }

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:236:17)

  console.log
    [TEST] ✅ LLM Risk Assessment from decompiled code:

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:258:17)

  console.log
    [TEST]   obfuscatedTax: false

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:259:17)

  console.log
    [TEST]   privilegeEscalation: true

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:260:17)

  console.log
    [TEST]   externalCallRisk: false

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:261:17)

  console.log
    [TEST]   logicBomb: false

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:262:17)

  console.log
    [TEST]   8-bit risk mask: 2 (0b00000010)

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:263:17)

  console.log
    [TEST]   reasoning: The contract contains privilege escalation where only the owner can subscribe agents, indicating potential centralization and misuse.

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:264:17)

PASS test/cre/HeimdallLive.spec.ts (33.315 s)
  Phase 2: Live Heimdall Microservice
    √ GET /health should return ok with Heimdall version (94 ms)
    √ POST /decompile should return decompiled logic for known bytecode (2743 ms)
    √ POST /decompile should reject empty bytecode (17 ms)
  Phase 3: Live Base Sepolia Pipeline
    √ should fetch live bytecode from Base Sepolia via eth_getCode (63 ms)
    √ should fetch bytecode AND decompile via full pipeline (3147 ms)
  Phase 4: Live LLM Consensus Integration
    √ should send Heimdall-decompiled code to live GPT-4o and get valid risk JSON (4966 ms)

Test Suites: 1 passed, 1 total
Tests:       6 passed, 6 total
Snapshots:   0 total
Time:        33.878 s, estimated 65 s
Ran all test suites matching test/cre/HeimdallLive.spec.ts.
