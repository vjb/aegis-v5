â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â•â•â•
     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ•â•â•â•â–ˆâ–ˆâ•‘
     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
     â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•â•â•â•â•  v5.0

  ğŸš€ AEGIS PROTOCOL: THE INSTITUTIONAL AI FIREWALL
  Zero-Custody Account Abstraction on Base Sepolia

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  We have upgraded from EOA wallets to ERC-4337 Smart Accounts.
  This live demo features:
    1. Zero-Custody ERC-7579 Modules
    2. Scoped ERC-7715 AI Session Keys
    3. Intents via Pimlico's Cloud Bundler
    4. LIVE Chainlink CRE AI Consensus

[Act 1] The Bank: Verifying Zero-Custody Treasury
The Aegis Module enforces the firewall but holds ZERO custody of user funds.
Capital stays in the ERC-7579 Module treasury â€” not in any EOA.
  Checking AegisModule treasury (0x23efaef29ecc0e6ce313f0eed3d5da7e0f5bcd89)... |/-\|/-\|/-\|/-\|/-   âœ… AegisModule treasury: 0.035 ETH
  The module has execution rights via subscribeAgent() but the owner
  controls all funds. Only requestAudit() and triggerSwap() are permitted.

[Act 2] The Keys: ERC-7715 Agent Session Provisioning
Instead of giving the AI a private key, we grant it a mathematically scoped Session Key.
  Generating restricted session keys for AI Agent NOVA... |/-\|/-\|/-\|/-\|/-\|/-\| 
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ERC-7715 Session Key â€” Agent NOVA                            â”‚
  â”‚                                                                â”‚
  â”‚  Permitted Selectors:                                          â”‚
  â”‚    requestAudit(address)                0xe34eac65          â”‚
  â”‚    triggerSwap(address,uint256,uint256)  0x684bceb0          â”‚
  â”‚                                                                â”‚
  â”‚  Target:  0x23efaef29ecc0e6ce313f0eed3d5da7e0f5bcd89      â”‚
  â”‚  Budget:  0.002 ETH per session                                â”‚
  â”‚  Expiry:  24 hours                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  NOVA cannot call transfer(), withdraw(), or any other function.
  âœ… Session Key mathematically signed and validated by the Safe.

[Act 3] The Intents: Agent NOVA Requesting Audits
Agent NOVA wants to buy two tokens. It submits audit requests on-chain.

> cast send 0x23efaef29ecc0e6ce313f0eed3d5da7e0f5bcd89 "requestAudit(address)" 0x46d40e0abda0814bb0cb323b2bb85a129d00b0ac
  Routing audit intent to Base Sepolia... |/-\|/-\|/-\|/-\|/-\   âœ… MockBRETT audit requested: 0x17eed20f27f4f5842015f918daea0017cb48c3b6f995a64ce367caf6f910a641

> cast send 0x23efaef29ecc0e6ce313f0eed3d5da7e0f5bcd89 "requestAudit(address)" 0xf672c8fc888b98db5c9662d26e657417a3c453b5
  Routing audit intent to Base Sepolia... |/-\|/-\|/-\|/-\|/-   âœ… MockHoneypot audit requested: 0x6c5c03d58cf3384794187bdc46af121b1f4ceca31c2a1c941de9604bb35c4c87

  Both AuditRequested events are now on-chain on Base Sepolia.

[Act 4] The AI Firewall: LIVE Chainlink CRE Intercept
The Chainlink DON detects AuditRequested events and triggers the WASM sandbox.
  Phase 1: GoPlus API â€” static on-chain analysis
  Phase 2: BaseScan â€” source code fetch via ConfidentialHTTPClient
  Phase 3: GPT-4o + Llama-3 â€” dual-model AI consensus

> docker exec -e AEGIS_DEMO_MODE=true aegis-oracle-node cre workflow simulate /app --target base-sepolia --evm-tx-hash 0x6c5c03d58cf3384794187bdc46af121b1f4ceca31c2a1c941de9604bb35c4c87 --trigger-index 0 --evm-event-index 0 --non-interactive

--- BEGIN RAW SECURE WASM EXECUTION ---

Initializing...
Checking RPC connectivity...
Compiling workflow...
âœ“ Workflow compiled
Fetching transaction receipt for 0x6c5c03d58cf3384794187bdc46af121b1f4ceca31c2a1c941de9604bb35c4c87...
2026-02-28T07:16:30Z [SIMULATION] Simulator Initialized

2026-02-28T07:16:30Z [SIMULATION] Running trigger trigger=evm:ChainSelector:10344971235874465080@1.0.0
2026-02-28T07:16:30Z [USER LOG] ğŸ›¡ï¸ AegisModule V4 | AuditRequested intercepted
2026-02-28T07:16:30Z [USER LOG] ğŸ›¡ï¸ AEGIS MODULE V4 | Auditing: 0xf672c8fc888b98db5c9662d26e657417a3c453b5
2026-02-28T07:16:30Z [USER LOG] [GoPlus] MOCK registry hit: MockHoneypot
2026-02-28T07:16:30Z [USER LOG] [GoPlus] unverified=0 sellRestriction=0 honeypot=1
2026-02-28T07:16:30Z [USER LOG] [BaseScan] Using MOCK source for MockHoneypot (917 chars)
2026-02-28T07:16:30Z [USER LOG] [AI] Contract under audit: MockHoneypot
2026-02-28T07:16:30Z [USER LOG] [AI] Prompt sent to AI (first 400 chars): You are the Aegis Protocol Lead Security Auditor for a DeFi firewall. Analyze this ERC-20 token contract for MALICIOUS patterns ONLY.

Return ONLY a valid JSON object with these exact boolean keys plus a reasoning string:
  obfuscatedTax: TRUE only if there is a hidden fee >  5% deducted inside _transfer/_update that is NOT clearly named 'tax' or 'fee'. Standard Ownable, renounceOwnership, or roya
2026-02-28T07:16:30Z [USER LOG] [AI] â†’ GPT-4o via ConfidentialHTTPClient | AEGIS_OPENAI_SECRET stays in DON
2026-02-28T07:16:31Z [USER LOG] [GPT-4o] HTTP 200
2026-02-28T07:16:31Z [USER LOG] [GPT-4o] Response: 
{
  "obfuscatedTax": false,
  "privilegeEscalation": true,
  "externalCallRisk": false,
  "logicBomb": false,
  "reasoning": "The contract restricts transfers to an owner-controlled allowlist, preventing non-approved users from selling their tokens."
}
2026-02-28T07:16:31Z [USER LOG] [GPT-4o] Risk bits â†’ tax=false priv=true extCall=false bomb=false
2026-02-28T07:16:31Z [USER LOG] [GPT-4o] Reasoning: The contract restricts transfers to an owner-controlled allowlist, preventing non-approved users from selling their tokens.
2026-02-28T07:16:31Z [USER LOG] [AI] â†’ Llama-3 via Groq ConfidentialHTTPClient | AEGIS_GROQ_SECRET stays in DON
2026-02-28T07:16:31Z [USER LOG] [Llama-3] HTTP 200
2026-02-28T07:16:31Z [USER LOG] [Llama-3] Response: {
  "obfuscatedTax": false,
   "privilegeEscalation": true,
   "externalCallRisk": false,
   "logicBomb": false,
   "reasoning": "MockHoneypot contract restricts transfers to an owner-controlled allowlist, allowing the owner to control who can sell their tokens."
}
2026-02-28T07:16:31Z [USER LOG] [Llama-3] Risk bits â†’ tax=false priv=true extCall=false bomb=false
2026-02-28T07:16:31Z [USER LOG] [Llama-3] Reasoning: MockHoneypot contract restricts transfers to an owner-controlled allowlist, allowing the owner to control who can sell their tokens.
2026-02-28T07:16:31Z [USER LOG] [AI] Union of Fears â†’ obfuscatedTax=0 privilegeEscalation=1 externalCallRisk=0 logicBomb=0
2026-02-28T07:16:31Z [USER LOG] âš–ï¸ Final Risk Code: 36
2026-02-28T07:16:31Z [USER LOG] âœ… onReport delivered to AegisModule at 0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89

âœ“ Workflow Simulation Result:
"Audit Complete"

2026-02-28T07:16:31Z [SIMULATION] Execution finished signal received
2026-02-28T07:16:31Z [SIMULATION] Skipping WorkflowEngineV2

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Simulation complete! Ready to deploy your workflow?  â”‚
â”‚                                                      â”‚
â”‚ Run cre account access to request deployment access. â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

--- END RAW SECURE WASM EXECUTION ---

  Delivering oracle verdicts to blockchain...
  Delivering BRETT verdict (riskScore=0)... |/-\|/-\|/-\|   âœ… MockBRETT:    Risk Code 0 â†’ APPROVED (isApproved = true)
  Delivering Honeypot verdict (riskScore=36)... |/-\|/-\|/-\|   âŒ MockHoneypot: Risk Code 36 â†’ DENIED (ClearanceDenied)

[Act 5] The Execution: JIT Swaps & Automated Reverts
Agent NOVA now attempts to execute both swaps against the firewall.

> triggerSwap(MockBRETT, 0.001 ETH)
  Submitting swap transaction... |/-\|/-\|/-\|/-\|/-\|/-   âœ… SWAP EXECUTED. MockBRETT cleared by AI. Tx: 0x0000000000000000000000000000000000000000000000000000000000000000

> triggerSwap(MockHoneypot, 0.001 ETH)
  Submitting swap transaction... |/-\|/-\|/-\|/-\|/-\|/- 
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘  EXECUTION REVERTED: TokenNotCleared()                    â•‘
  â•‘                                                            â•‘
  â•‘  The AegisModule BLOCKED the honeypot swap.                â•‘
  â•‘  Zero capital at risk. The AI firewall held.               â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ›¡ï¸ The AegisModule successfully blocked the malicious transaction on-chain.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 âœ… DEMO COMPLETE: 100% ON-CHAIN AI FIREWALL ENFORCEMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ SUMMARY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                                          â”‚
  â”‚  MockBRETT:     requestAudit â†’ CRE Risk 0  â†’ triggerSwap âœ… SUCCESS     â”‚
  â”‚  MockHoneypot:  requestAudit â†’ CRE Risk 36 â†’ triggerSwap âŒ REVERT      â”‚
  â”‚                                                                          â”‚
  â”‚  Stack: ERC-4337 + ERC-7579 + Chainlink CRE + Pimlico Bundler           â”‚
  â”‚  Chain: Base Sepolia (84532)                                             â”‚
  â”‚  Oracle: GoPlus + BaseScan + GPT-4o + Llama-3 (dual-AI consensus)       â”‚
  â”‚                                                                          â”‚
  â”‚  Zero-Custody. Zero-Trust. Total Protection.                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

