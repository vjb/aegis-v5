PASS test/frontend.spec.ts (34.597 s)
PASS test/bot.spec.ts (34.907 s)
PASS test/oracle.spec.ts
PASS test/bot_v5.spec.ts (36.516 s)
PASS test/safe_setup.spec.ts
PASS test/session_key.spec.ts (36.585 s)
PASS test/visualizer/ConsensusVisualizer.spec.tsx (36.269 s)
PASS test/session_install.spec.ts (38.715 s)
PASS test/cre/HeimdallLive.spec.ts (46.375 s)
  ● Console

    console.log
      [TEST] Decompiled 19666 hex chars → 15000 chars in 4063ms

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:89:17)

    console.log
      [TEST] First 300 chars:
      // SPDX-License-Identifier: MIT
      pragma solidity >=0.8.0;
      
      /// @title            Decompiled Contract
      /// @author           Jonathan Becker <jonathan@jbecker.dev>
      /// @custom:version   heimdall-rs v0.9.2
      ///
      /// @notice           This contract was decompiled using the heimdall-rs decompiler.
      ///

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:90:17)

    console.log
      [TEST] Live bytecode for AegisModule: 19666 hex chars

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:120:17)

    console.log
      [TEST] Full pipeline: Base Sepolia → Heimdall → 15000 chars of decompiled code

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:147:17)

    console.log
      [TEST] Step 1: Fetched 19666 hex chars from Base Sepolia

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:169:17)

    console.log
      [TEST] Step 2: Heimdall decompiled → 8000 chars

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:180:17)

    console.log
      [TEST] Step 3: GPT-4o raw response: {
        "obfuscatedTax": false,
        "privilegeEscalation": true,
        "externalCallRisk": false,
        "logicBomb": false,
        "is_malicious": true,
        "reasoning": "The contract contains privilege escalation where only the owner can subscribe agents, indicating potential centralization and control risks."
      }

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:236:17)

    console.log
      [TEST] ✅ LLM Risk Assessment from decompiled code:

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:258:17)

    console.log
      [TEST]   obfuscatedTax: false

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:259:17)

    console.log
      [TEST]   privilegeEscalation: true

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:260:17)

    console.log
      [TEST]   externalCallRisk: false

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:261:17)

    console.log
      [TEST]   logicBomb: false

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:262:17)

    console.log
      [TEST]   8-bit risk mask: 2 (0b00000010)

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:263:17)

    console.log
      [TEST]   reasoning: The contract contains privilege escalation where only the owner can subscribe agents, indicating potential centralization and control risks.

      at Object.<anonymous> (test/cre/HeimdallLive.spec.ts:264:17)


Test Suites: 9 passed, 9 total
Tests:       1 skipped, 97 passed, 98 total
Snapshots:   0 total
Time:        48.676 s
Ran all test suites.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
