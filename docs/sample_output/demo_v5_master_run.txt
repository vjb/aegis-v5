â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â•â•â•
     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ•â•â•â•â–ˆâ–ˆâ•‘
     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
     â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•â•â•â•â•  v5.0

  ğŸš€ AEGIS PROTOCOL: THE INSTITUTIONAL AI FIREWALL
  Zero-Custody Account Abstraction on Base Sepolia

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  We have upgraded from EOA wallets to ERC-4337 Smart Accounts.
  This live demo features:
    1. Zero-Custody ERC-7579 Modules
    2. Scoped ERC-7715 AI Session Keys
    3. Intents via Pimlico's Cloud Bundler
    4. LIVE Chainlink CRE AI Consensus

[Act 1] The Bank: Verifying Zero-Custody Treasury
  Checking AegisModule treasury (0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89)... |/-\|/-\|/-\|/-\|/-   âœ… AegisModule treasury: 0.085 ETH
  â„¹ï¸  The module has execution rights but the owner controls all funds.

[Act 2] The Keys: Subscribing AI Agents

  Subscribing Agent NOVA (0.05 ETH budget)...
> cast send 0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89 "subscribeAgent(address,uint256)" 0xba5359fac9736e687c39d9613de3e8fa6c7af1ce 50000000000000000
  Broadcasting subscribeAgent(NOVA)... |/-\|/-\|/-\|/-\|/   âœ… NOVA subscribed â€” tx: 0x1d0491b2a8ab82c0â€¦
  Subscribing Agent CIPHER (0.008 ETH budget)...
> cast send 0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89 "subscribeAgent(address,uint256)" 0x6e9972213bf459853fa33e28ab7219e9157c8d02 8000000000000000
  Broadcasting subscribeAgent(CIPHER)... |/-\|/-\|/-\|/-\|/-   âœ… CIPHER subscribed â€” tx: 0x8f793d390305c8a3â€¦

  Both agents are now registered on-chain. Here's what their session keys permit:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ERC-7715 Session Key â€” Agent NOVA                            â”‚
  â”‚                                                                â”‚
  â”‚  Permitted Selectors:                                          â”‚
  â”‚    requestAudit(address)                0xe34eac65          â”‚
  â”‚    triggerSwap(address,uint256,uint256)  0x684bceb0          â”‚
  â”‚                                                                â”‚
  â”‚  Target:  0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89      â”‚
  â”‚  Budget:  0.05 ETH (enforced on-chain)                         â”‚
  â”‚  Expiry:  24 hours                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  NOVA cannot call transfer(), withdraw(), or any other function.
  âœ… Both agents subscribed. Session keys scoped and validated.

[Act 3] The Intents: Agent NOVA Requesting Audits

> cast send 0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89 "requestAudit(address)" 0x46d40e0aBdA0814bb0CB323B2Bb85a129d00B0AC
  Routing audit intent to Base Sepolia... |/-\|/-\|/-\|/-\|/-   âœ… MockBRETT audit requested: 

> cast send 0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89 "requestAudit(address)" 0xf672c8fc888b98db5c9662d26e657417a3c453b5
  Routing audit intent to Base Sepolia... |/-\|/-\|/-\|/-\|/-   âœ… MockHoneypot audit requested: 0xa12828d674ba4f3be7179bf65ee8a557156ecc8173512fb3f651daef61fa0b39

  Both AuditRequested events are now on-chain on Base Sepolia.

[Act 4] The AI Firewall: LIVE Chainlink CRE Intercept

> docker exec -e AEGIS_DEMO_MODE=true aegis-oracle-node cre workflow simulate /app --target base-sepolia --evm-tx-hash 0xa12828d674ba4f3be7179bf65ee8a557156ecc8173512fb3f651daef61fa0b39 --trigger-index 0 --evm-event-index 0 --non-interactive

--- BEGIN RAW SECURE WASM EXECUTION ---

Initializing...
Checking RPC connectivity...
Compiling workflow...
âœ“ Workflow compiled
Fetching transaction receipt for 0xa12828d674ba4f3be7179bf65ee8a557156ecc8173512fb3f651daef61fa0b39...
2026-03-01T19:41:29Z [SIMULATION] Simulator Initialized

2026-03-01T19:41:29Z [SIMULATION] Running trigger trigger=evm:ChainSelector:10344971235874465080@1.0.0
2026-03-01T19:41:29Z [USER LOG] ğŸ›¡ï¸ AegisModule V5 | AuditRequested intercepted
2026-03-01T19:41:29Z [USER LOG] ğŸ›¡ï¸ AEGIS MODULE V5 | Auditing: 0xf672c8fc888b98db5c9662d26e657417a3c453b5
2026-03-01T19:41:29Z [USER LOG] [GoPlus] MOCK registry hit: MockHoneypot
2026-03-01T19:41:29Z [USER LOG] [GoPlus] unverified=0 sellRestriction=0 honeypot=1
2026-03-01T19:41:29Z [USER LOG] [BaseScan] Using MOCK source for MockHoneypot (917 chars)
2026-03-01T19:41:29Z [USER LOG] [AI] Contract under audit: MockHoneypot
2026-03-01T19:41:29Z [USER LOG] [AI] Prompt sent to AI (first 400 chars): You are the Aegis Protocol Lead Security Auditor for a DeFi firewall. Analyze this ERC-20 token contract for MALICIOUS patterns ONLY.

Return ONLY a valid JSON object with these exact boolean keys plus a reasoning string:
  obfuscatedTax: TRUE only if there is a hidden fee >  5% deducted inside _transfer/_update that is NOT clearly named 'tax' or 'fee'. Standard Ownable, renounceOwnership, or roya
2026-03-01T19:41:29Z [USER LOG] [AI] â†’ GPT-4o via ConfidentialHTTPClient | AEGIS_OPENAI_SECRET stays in DON
2026-03-01T19:41:31Z [USER LOG] [GPT-4o] HTTP 200
2026-03-01T19:41:31Z [USER LOG] [GPT-4o] Response: {
  "obfuscatedTax": false,
  "privilegeEscalation": true,
  "externalCallRisk": false,
  "logicBomb": false,
  "reasoning": "The contract restricts transfers to an owner-controlled allowlist, preventing non-approved users from selling their tokens."
}
2026-03-01T19:41:31Z [USER LOG] [GPT-4o] Risk bits â†’ tax=false priv=true extCall=false bomb=false
2026-03-01T19:41:31Z [USER LOG] [GPT-4o] Reasoning: The contract restricts transfers to an owner-controlled allowlist, preventing non-approved users from selling their tokens.
2026-03-01T19:41:31Z [USER LOG] [AI] â†’ Llama-3 via Groq ConfidentialHTTPClient | AEGIS_GROQ_SECRET stays in DON
2026-03-01T19:41:31Z [USER LOG] [Llama-3] HTTP 200
2026-03-01T19:41:31Z [USER LOG] [Llama-3] Response: {
  "obfuscatedTax": false,
   "privilegeEscalation": true,
   "externalCallRisk": false,
   "logicBomb": false,
   "reasoning": "MockHoneypot contract restricts transfers to an owner-controlled allowlist, allowing the owner to control who can sell their tokens."
}
2026-03-01T19:41:31Z [USER LOG] [Llama-3] Risk bits â†’ tax=false priv=true extCall=false bomb=false
2026-03-01T19:41:31Z [USER LOG] [Llama-3] Reasoning: MockHoneypot contract restricts transfers to an owner-controlled allowlist, allowing the owner to control who can sell their tokens.
2026-03-01T19:41:31Z [USER LOG] [AI] Union of Fears â†’ obfuscatedTax=0 privilegeEscalation=1 externalCallRisk=0 logicBomb=0
2026-03-01T19:41:31Z [USER LOG] âš–ï¸ Final Risk Code: 0
2026-03-01T19:41:32Z [USER LOG] âœ… onReport delivered to AegisModule at 0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89

âœ“ Workflow Simulation Result:
"Audit Complete"

2026-03-01T19:41:32Z [SIMULATION] Execution finished signal received
2026-03-01T19:41:32Z [SIMULATION] Skipping WorkflowEngineV2

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Simulation complete! Ready to deploy your workflow?  â”‚
â”‚                                                      â”‚
â”‚ Run cre account access to request deployment access. â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

--- END RAW SECURE WASM EXECUTION ---

  Delivering oracle verdicts to blockchain...
  Delivering BRETT verdict (riskScore=0)... |/-\|/-\|/-\|   âœ… MockBRETT:    Risk Code 0 â†’ APPROVED (isApproved = true)
  Delivering Honeypot verdict (riskScore=36)... |/-\|/-\|/-\|   âŒ MockHoneypot: Risk Code 36 â†’ DENIED (ClearanceDenied)

[Act 5] The Execution: JIT Swaps & Automated Reverts
Agent NOVA now attempts to execute both swaps against the firewall.

> triggerSwap(MockBRETT, 0.001 ETH)
  Submitting swap transaction... |/-\|/-\|/-\|/-\|/-\|/-\|/   âš ï¸ Swap result: Error: Failed to estimate gas: server returned an error response: error code 3: execution reverted, data: "0xd7dcf7f2": TokenNotCleared

> triggerSwap(MockHoneypot, 0.001 ETH)
  Submitting swap transaction... |/-\|/-\|/-\|/-\|/-\|/-\|/ 
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘  EXECUTION REVERTED: TokenNotCleared()                    â•‘
  â•‘                                                            â•‘
  â•‘  The AegisModule BLOCKED the honeypot swap.                â•‘
  â•‘  Zero capital at risk. The AI firewall held.               â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ›¡ï¸ The AegisModule successfully blocked the malicious transaction on-chain.

[Act 6] Budget Verification
> cast call 0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89 "agentAllowances(address)" 0xba5359fac9736e687c39d9613de3e8fa6c7af1ce
  ğŸ“Š NOVA remaining budget: 0x00000000000000000000000000000000000000000000000000b1a2bc2ec50000
  â„¹ï¸  Budget is mathematically enforced â€” NOVA cannot exceed its allowance.
> cast call 0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89 "agentAllowances(address)" 0x6e9972213bf459853fa33e28ab7219e9157c8d02
  ğŸ“Š CIPHER remaining budget: 0x000000000000000000000000000000000000000000000000001c6bf526340000

[Act 7] The Kill Switch
  First, subscribing Agent REX (0.01 ETH budget)...
  âœ… REX subscribed â€” budget: 0.01 ETH
  ğŸ”´ Now revoking Agent REX...
> cast send 0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89 "revokeAgent(address)" 0x7b1afe2745533d852d6fd5a677f14c074210d896
  Broadcasting revokeAgent(REX)... |/-\|/-\|/-\|/-\|/-   âœ… Agent REX REVOKED â€” budget zeroed, access denied
  â„¹ï¸  REX allowance after revoke: 0x0000000000000000000000000000000000000000000000000000000000000000 (should be 0)
  ğŸ›¡ï¸ The kill switch works. REX has zero access.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 âœ… DEMO COMPLETE: FULL AGENT LIFECYCLE ON BASE SEPOLIA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ âœ… subscribeAgent  â€” Owner grants NOVA + CIPHER budgets  â”‚
  â”‚ âœ… requestAudit    â€” Agent submits trade intents          â”‚
  â”‚ âœ… CRE Oracle      â€” GoPlus + BaseScan + GPT-4o + Llama  â”‚
  â”‚ âœ… onReportDirect  â€” Oracle delivers 8-bit risk verdict   â”‚
  â”‚ âœ… triggerSwap     â€” JIT swap executes for clean tokens   â”‚
  â”‚ âŒ TokenNotCleared â€” Honeypot swap BLOCKED on-chain      â”‚
  â”‚ âœ… agentAllowances â€” Budget deducted after successful tx  â”‚
  â”‚ âœ… revokeAgent     â€” Owner kills REX access instantly     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ STACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                                          â”‚
  â”‚  MockBRETT:     requestAudit â†’ CRE Risk 0  â†’ triggerSwap âœ… SUCCESS     â”‚
  â”‚  MockHoneypot:  requestAudit â†’ CRE Risk 36 â†’ triggerSwap âŒ REVERT      â”‚
  â”‚                                                                          â”‚
  â”‚  Stack: ERC-4337 + ERC-7579 + Chainlink CRE + Pimlico Bundler           â”‚
  â”‚  Chain: Base Sepolia (84532)                                             â”‚
  â”‚  Oracle: GoPlus + BaseScan + GPT-4o + Llama-3 (dual-AI consensus)       â”‚
  â”‚                                                                          â”‚
  â”‚  Zero-Custody. Zero-Trust. Total Protection.                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

