â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â•â•â•
     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ•â•â•â•â–ˆâ–ˆâ•‘
     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
     â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•â•â•â•â•  v5.0

  ğŸ”— CHAINLINK CRE: CONFIDENTIAL AI CONSENSUS
  Raw WASM Execution â€” No Frontend, No Abstraction

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[Scene 1] Booting Decentralized Firewall Infrastructure...
  â¤ Network:      Base Sepolia (Public Testnet)
  â¤ Module:       0x23efaef29ecc0e6ce313f0eed3d5da7e0f5bcd89 (ERC-7579)
  â¤ Target:       0xf672c8fc888b98db5c9662d26e657417a3c453b5 (Known Honeypot)

[Scene 2] Generating live 'AuditRequested' event...
  â„¹ï¸  Simulating Agent NOVA routing ERC-4337 intent through Pimlico...

> cast send 0x23efaef29ecc0e6ce313f0eed3d5da7e0f5bcd89 "requestAudit(address)" 0xf672c8fc888b98db5c9662d26e657417a3c453b5 --rpc-url https://sepolia.base.org --private-key <PRIVATE_KEY>
  Awaiting Base Sepolia Block Confirmation...    âœ… UserOperation Confirmed. AuditRequested Event Emitted.
  â¤ TxHash: 0x8f7bc0910553101521fe5aaffa9bdcae5b628a1f006f459402dd05fcd07df062

==========================================================================
 âš™ï¸ CHAINLINK RUNTIME ENVIRONMENT (CRE) SECURE EXECUTION
==========================================================================

> docker exec -e AEGIS_DEMO_MODE=true aegis-oracle-node cre workflow simulate /app --target base-sepolia --evm-tx-hash 0x8f7bc0910553101521fe5aaffa9bdcae5b628a1f006f459402dd05fcd07df062 --trigger-index 0 --evm-event-index 0 --non-interactive

--- BEGIN RAW SECURE WASM EXECUTION ---

Initializing...
Checking RPC connectivity...
Compiling workflow...
âœ“ Workflow compiled
Fetching transaction receipt for 0x8f7bc0910553101521fe5aaffa9bdcae5b628a1f006f459402dd05fcd07df062...
2026-02-28T19:51:35Z [SIMULATION] Simulator Initialized

2026-02-28T19:51:35Z [SIMULATION] Running trigger trigger=evm:ChainSelector:10344971235874465080@1.0.0
2026-02-28T19:51:35Z [USER LOG] ğŸ›¡ï¸ AegisModule V5 | AuditRequested intercepted
2026-02-28T19:51:36Z [USER LOG] ğŸ›¡ï¸ AEGIS MODULE V5 | Auditing: 0xf672c8fc888b98db5c9662d26e657417a3c453b5
2026-02-28T19:51:36Z [USER LOG] [GoPlus] MOCK registry hit: MockHoneypot
2026-02-28T19:51:36Z [USER LOG] [GoPlus] unverified=0 sellRestriction=0 honeypot=1
2026-02-28T19:51:36Z [USER LOG] [BaseScan] Using MOCK source for MockHoneypot (917 chars)
2026-02-28T19:51:36Z [USER LOG] [AI] Contract under audit: MockHoneypot
2026-02-28T19:51:36Z [USER LOG] [AI] Prompt sent to AI (first 400 chars): You are the Aegis Protocol Lead Security Auditor for a DeFi firewall. Analyze this ERC-20 token contract for MALICIOUS patterns ONLY.

Return ONLY a valid JSON object with these exact boolean keys plus a reasoning string:
  obfuscatedTax: TRUE only if there is a hidden fee >  5% deducted inside _transfer/_update that is NOT clearly named 'tax' or 'fee'. Standard Ownable, renounceOwnership, or roya
2026-02-28T19:51:36Z [USER LOG] [AI] â†’ GPT-4o via ConfidentialHTTPClient | AEGIS_OPENAI_SECRET stays in DON
2026-02-28T19:51:37Z [USER LOG] [GPT-4o] HTTP 200
2026-02-28T19:51:37Z [USER LOG] [GPT-4o] Response: {
  "obfuscatedTax": false,
  "privilegeEscalation": true,
  "externalCallRisk": false,
  "logicBomb": false,
  "reasoning": "The contract restricts transfers to an owner-controlled allowlist, preventing non-approved users from selling their tokens."
}
2026-02-28T19:51:37Z [USER LOG] [GPT-4o] Risk bits â†’ tax=false priv=true extCall=false bomb=false
2026-02-28T19:51:37Z [USER LOG] [GPT-4o] Reasoning: The contract restricts transfers to an owner-controlled allowlist, preventing non-approved users from selling their tokens.
2026-02-28T19:51:37Z [USER LOG] [AI] â†’ Llama-3 via Groq ConfidentialHTTPClient | AEGIS_GROQ_SECRET stays in DON
2026-02-28T19:51:38Z [USER LOG] [Llama-3] HTTP 200
2026-02-28T19:51:38Z [USER LOG] [Llama-3] Response: {
  "obfuscatedTax": false,
   "privilegeEscalation": true,
   "externalCallRisk": false,
   "logicBomb": false,
   "reasoning": "MockHoneypot contract restricts transfers to an owner-controlled allowlist, allowing the owner to control who can sell their tokens."
}
2026-02-28T19:51:38Z [USER LOG] [Llama-3] Risk bits â†’ tax=false priv=true extCall=false bomb=false
2026-02-28T19:51:38Z [USER LOG] [Llama-3] Reasoning: MockHoneypot contract restricts transfers to an owner-controlled allowlist, allowing the owner to control who can sell their tokens.
2026-02-28T19:51:38Z [USER LOG] [AI] Union of Fears â†’ obfuscatedTax=0 privilegeEscalation=1 externalCallRisk=0 logicBomb=0
2026-02-28T19:51:38Z [USER LOG] âš–ï¸ Final Risk Code: 36
2026-02-28T19:51:39Z [USER LOG] âœ… onReport delivered to AegisModule at 0x23EfaEF29EcC0e6CE313F0eEd3d5dA7E0f5Bcd89

âœ“ Workflow Simulation Result:
"Audit Complete"

2026-02-28T19:51:39Z [SIMULATION] Execution finished signal received
2026-02-28T19:51:39Z [SIMULATION] Skipping WorkflowEngineV2

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Simulation complete! Ready to deploy your workflow?  â”‚
â”‚                                                      â”‚
â”‚ Run cre account access to request deployment access. â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

--- END RAW SECURE WASM EXECUTION ---

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 âœ… CRE CONSENSUS COMPLETE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ âœ… WASM Sandbox   â€” Deterministic execution achieved    â”‚
  â”‚ âœ… GoPlus API     â€” Static on-chain scam detection      â”‚
  â”‚ âœ… BaseScan       â€” ConfidentialHTTP source retrieval   â”‚
  â”‚ âœ… GPT-4o         â€” Deep semantic forensics (Right)     â”‚
  â”‚ âœ… Llama-3        â€” High-speed consensus (Left)         â”‚
  â”‚ âœ… Union of Fears â€” Maximally conservative bitmask      â”‚
  â”‚ âœ… ABI Payload    â€” Ready for on-chain callback         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  The Chainlink WASM sandbox successfully:
    1. Masked API keys via Confidential HTTP.
    2. Achieved multi-model consensus between GPT-4o and Llama-3.
    3. Prepared the ABI-encoded payload for the ERC-7579 module.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Next Step: Run .\scripts\demo_v5_master.ps1 -Interactive

